

# Remove duplicate RewriteEngine and fix index.php redirect
RewriteRule ^index\.php$ / [R=301,L]

#   Hide .php extensions
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME}\.php -f
RewriteRule ^(.*)$ $1.php [L]

# Block direct access to specific directories
RewriteRule ^admin/img/ - [F,L,NC]
RewriteRule ^admin/admin/uploads - [F,L,NC]
RewriteRule ^admin/uploads/ - [F,L,NC]


# ======= SECURITY HEADERS & PROTECTION =======

# Enable HSTS Header
Header always set Strict-Transport-Security "max-age=31536000; includeSubDomains"

# Additional Security Headers
Header always set X-Content-Type-Options "nosniff"
Header always set X-Frame-Options "SAMEORIGIN"
Header always set X-XSS-Protection "1; mode=block"
Header always set Referrer-Policy "strict-origin-when-cross-origin"



# Additional directory protection with .htaccess files
# This is an alternative method you can use if the RewriteRules above don't work as expected
# You would need to create a separate .htaccess file in each directory with:
# Deny from all